const UNSPLASH_KEY = "PASTE_YOUR_UNSPLASH_ACCESS_KEY_HERE";
const UNSPLASH_KEY = "a1b2c3d4examplekey";

const searchInput = document.getElementById("searchInput");

searchInput.addEventListener("keydown", (e) => {
  if (e.key === "Enter") {
    e.preventDefault();           // stop form submit / reload
    document.getElementById("suggestions").innerHTML = "";
    searchWiki();                 // trigger search
  }
});
async function searchWiki() {
  const input = document.getElementById("searchInput");
  const query = input.value.trim();
  const resultsDiv = document.getElementById("results");

  document.getElementById("suggestions").innerHTML = "";

  if (!query) {
    resultsDiv.innerHTML = "<p>Please enter something to search.</p>";
    return;
  }

  saveToHistory(query);

  resultsDiv.innerHTML = "<p>üîÑ Searching...</p>";

  const encodedQuery = encodeURIComponent(query);

  // ===== AI TAB =====
  if (activeTab === "ai") {
    try {
      const res = await fetch(
        `https://en.wikipedia.org/api/rest_v1/page/summary/${encodedQuery}`
      );
      const data = await res.json();

      const answer = data.extract || "No AI explanation found.";

      resultsDiv.innerHTML = `
        <div class="ai-card">
          <div class="ai-title">
            <span>ü§ñ</span> AI Answer
          </div>
          <div id="aiText"></div>
        </div>
      `;

      typeEffect(
        document.getElementById("aiText"),
        `Here‚Äôs a simple explanation:\n\n${answer}`
      );

    } catch {
      resultsDiv.innerHTML = "<p>AI failed to respond.</p>";
    }
    return;
  }

  // ===== IMAGES TAB (placeholder) =====
  if (activeTab === "images") {
    resultsDiv.innerHTML =
      "<p>üñº Image search coming soon...</p>";
    return;
  }

  // ===== ALL / WIKI TAB =====
  try {
    const response = await fetch(
      `https://en.wikipedia.org/w/api.php?action=query&list=search&srsearch=${encodedQuery}&format=json&origin=*`
    );
    const data = await response.json();

    resultsDiv.innerHTML = "";

    if (data.query.search.length === 0) {
      resultsDiv.innerHTML = "<p>No results found.</p>";
      return;
    }

    data.query.search.forEach(item => {
      const card = document.createElement("div");
      card.className = "result-card";
      card.innerHTML = `
        <h3>${item.title}</h3>
        <p>${item.snippet}...</p>
      `;
      resultsDiv.appendChild(card);
    });

  } catch {
    resultsDiv.innerHTML = "<p>Error fetching search results.</p>";
  }
}
if (activeTab === "ai") {
  const url = `https://en.wikipedia.org/api/rest_v1/page/summary/${query}`;

  try {
    const res = await fetch(url);
    const data = await res.json();

    const answer = data.extract || 
      "I couldn't find detailed information, but try refining your question.";

    resultsDiv.innerHTML = `
      <div class="ai-card">
        <div class="ai-title">
          <span>ü§ñ</span>
          AI Answer
        </div>
        <div id="aiText" class="typing"></div>
      </div>
    `;

    typeEffect(
      document.getElementById("aiText"),
      `Here‚Äôs a simple explanation:\n\n${answer}`
    );

  } catch (e) {
    resultsDiv.innerHTML = `
      <div class="ai-card">
        <div class="ai-title">
          <span>‚ö†Ô∏è</span>
          AI Error
        </div>
        <p>Unable to generate AI response right now.</p>
      </div>
    `;
  }
  return;
}

document.querySelectorAll(".nav-item").forEach(item => {
  item.addEventListener("click", () => {
    document.querySelectorAll(".nav-item").forEach(i =>
      i.classList.remove("active")
    );
    item.classList.add("active");
  });
});
function typeEffect(element, text, speed = 20) {
  element.innerHTML = "";
  let i = 0;

  const interval = setInterval(() => {
    element.innerHTML += text.charAt(i);
    i++;
    if (i >= text.length) clearInterval(interval);
  }, speed);
}
fetch("https://api.openai.com/v1/chat/completions", ...)

function saveToHistory(query) {
  let history = JSON.parse(localStorage.getItem("searchHistory")) || [];
  history = history.filter(item => item !== query);
  history.unshift(query);
  if (history.length > 8) history.pop();
  localStorage.setItem("searchHistory", JSON.stringify(history));
}
function typeEffect(el, text, speed = 20) {
  el.innerHTML = "";
  let i = 0;
  const timer = setInterval(() => {
    el.innerHTML += text.charAt(i);
    i++;
    if (i >= text.length) clearInterval(timer);
  }, speed);
}
async function searchImages(query) {
  const resultsDiv = document.getElementById("results");
  resultsDiv.innerHTML = "<p>üñº Searching images...</p>";

  try {
    const res = await fetch(
      `https://api.unsplash.com/search/photos?query=${query}&per_page=12&client_id=${UNSPLASH_KEY}`
    );

    const data = await res.json();

    if (data.results.length === 0) {
      resultsDiv.innerHTML = "<p>No images found.</p>";
      return;
    }

    resultsDiv.innerHTML = `<div class="image-grid"></div>`;
    const grid = document.querySelector(".image-grid");

    data.results.forEach(photo => {
      const img = document.createElement("img");
      img.src = photo.urls.small;
      img.alt = photo.alt_description || "Image result";

      img.onclick = () => {
        window.open(photo.links.html, "_blank");
      };

      grid.appendChild(img);
    });

  } catch (err) {
    resultsDiv.innerHTML = "<p>Error loading images.</p>";
  }
}



